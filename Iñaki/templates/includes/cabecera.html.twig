<link rel="stylesheet" href="{{ asset('CSS/cabecera.css') }}">
<header>
    <nav>
        <ul>
            {% if app.User is not null %}
                <li><a id="nombre">Bienvenido: {{app.User.NombreUsuario}}</a></li>
            {% endif %}
            <li><a href="{{ path('home') }}" class="enlaces_nav">Inicio</a></li>
            <li><a href="{{ path('usuarios')}}" class="enlaces_nav">Usuarios</a></li>
            {% if app.User is not null %}
                <li><a href="{{ path('perfil',{'id': app.User.IdUsuario}) }}" class="enlaces_nav">Perfil</a></li>
            {% endif %}
            <li><a href="{{ path('amistad') }}" class="enlaces_nav">Amistades Pendientes</a></li>
            <li>
                {% if app.request.attributes.get('_route') == 'usuarios' %}
                    <input type="text" id="buscador" placeholder="Buscar por nombre o correo">
                {% endif %}
            </li>
            
            <li><a href="{{ path('app_logout') }}" class="enlaces_nav">Cerrar Sesión</a></li>
        </ul>
    </nav>
</header>

<script>
    function filtrarUsuarios() {
        var busqueda = document.getElementById("buscador").value.trim().toLowerCase();
        var perfilesDiv = document.getElementById("perfiles");
        var perfiles = perfilesDiv.querySelectorAll(".usuario");
        perfiles.forEach(function(perfil) {
            var nombreUsuario = perfil.querySelector("h3").textContent.toLowerCase();
            var correoUsuario = perfil.querySelector("p:nth-of-type(1)").textContent.toLowerCase();

            // Mostrar todos los perfiles si la búsqueda está vacía
            if (busqueda === '') {
                perfil.style.display = "block";
            } else {
                var regex = new RegExp(busqueda, 'i');
                if (nombreUsuario.match(regex) || correoUsuario.match(regex)) {
                    perfil.style.display = "block";
                } else {
                    perfil.style.display = "none";
                }
            }
        });
    }
    document.getElementById("buscador").addEventListener("keydown", function(event) {
        if (event.key === "Enter") {
            filtrarUsuarios();
        }
    });
</script>
